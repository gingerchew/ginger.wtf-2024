{% edge "njk", page.url %}
    {#<form action="/style/" method="POST" onsubmit="umtc">
        <input type="hidden" id="$toggleDarkModeSrc" name="src" value="{{ _ }}" />
        <input type="hidden" id="$toggleDarkModeInput" name="mode" value="{{ 'light' if mode === 'dark' else 'dark' }}" />#}
        <button 
            class="toggle-dark-mode" 
            id="$toggleDarkMode"
            data-mode="{{ eleventy.edge.cookies.mode | default('light') | escape | safe }}"
        >
            <span class="visually-hidden">Toggle dark mode</span>
            <span class="show-dark"><span class="gg-moon"></span></span>
            <span class="show-light"><span class="gg-sun"></span></span>
        </button>

    {#</form>#}
    <script type="module">
        $toggleDarkMode.onclick = async ({ target }) => {
            const nextMode = target.dataset.mode === 'light' ? 'dark' : 'light';
            try {
                const result = await navigator.sendBeacon('{{ meta.url }}/style/', new URLSearchParams({
                    mode: nextMode,
                }));
                document.cookie = `mode=${nextMode}; SameSite=Lax; HTTPOnly=true; Secure=true;`;
                target.dataset.mode = nextMode
            } catch(e) {
                console.log('Error: ', e.message);
            }
        }
    </script>
{% endedge %}